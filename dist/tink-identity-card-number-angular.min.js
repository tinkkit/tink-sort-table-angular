/*! tink-identity-card-number-angular v1.0.0 */
"use strict";!function(module){try{module=angular.module("tink.identitycardnumber")}catch(e){module=angular.module("tink.identitycardnumber",["tink.safeApply","tink.formathelper"])}module.directive("tinkIdentityNumber",["$window","safeApply",function($window,safeApply){return{restrict:"AE",controller:"tinkFormatController",require:["tinkIdentityNumber","ngModel","?^form"],template:function(){var isNative=/(ip(a|o)d|iphone|android)/gi.test($window.navigator.userAgent),isTouch="createTouch"in $window.document&&isNative;return isTouch?'<div><input class="hide-styling" type="text"><div>':'<div tabindex="-1"><div id="input" class="faux-input" contenteditable="true">{{placeholder}}</div></div>'},link:function(scope,elm,attr,ctrl){function validFormat(value){return value&&11===value.length?value.match(/[0-9]*/g):value&&15===value.length?value.match(/[0-9][0-9][0-9]-[0-9][0-9][0-9][0-9][0-9][0-9][0-9]-[0-9][0-9]/g):!1}function isRRNoValid(n){if("string"!=typeof n&&12!==n.length)return!1;n=n.replace(/[^\d]*/g,"");var checkDigit=n.substr(n.length-2,2),modFunction=function(nr){var modu=nr%97;return 0===modu?97:parseInt(modu)},nrToCheck=parseInt(n.substr(0,10));return modFunction(nrToCheck)===parseInt(checkDigit)?!0:!1}function checkvalidty(value){value===config.placeholder||""===value||null===value||void 0===value?ngControl.$setValidity("format",!0):ngControl.$setValidity("format",isRRNoValid(value)),isRequired&&(controller.getValue()===config.placeholder||""===value||null===value||void 0===value?(ngControl.$setValidity("required",!1),ngControl.$setValidity("format",!0)):ngControl.$setValidity("required",!0))}elm.attr("tabindex","-1");var isNative=/(ip(a|o)d|iphone|android)/gi.test($window.navigator.userAgent),isTouch="createTouch"in $window.document&&isNative,controller=ctrl[0],form=ctrl[2],ngControl=ctrl[1],element=elm.find("div>:first"),config={format:"000-0000000-00",placeholder:"xxx-xxxxxxx-xx"};ngControl.$parsers.unshift(function(value){return checkvalidty(value),value}),ngControl.$formatters.push(function(modelValue){return void 0!==modelValue&&(modelValue&&11===modelValue.length&&(modelValue=modelValue.substr(0,2)+"."+modelValue.substr(2,2)+"."+modelValue.substr(4,2)+"-"+modelValue.substr(6,3)+"-"+modelValue.substr(9,2)),validFormat(modelValue)?isTouch?element.val(modelValue):controller.setValue(modelValue,null):(modelValue=null,ngControl.$setViewValue(modelValue)),checkvalidty(modelValue)),modelValue}),element.unbind("input").unbind("keydown").unbind("change"),element.on("blur",function(){safeApply(scope,function(){var value;value=isTouch?element.val():controller.getValue(),checkvalidty(value),isRRNoValid(value)?(ngControl.$setViewValue(value),ngControl.$render()):ngControl.$setViewValue(null)})});var isRequired=function(){return"true"===attr.required||""===attr.required||"required"===attr.required?!0:!1}();isTouch||controller.init(element,config,form,ngControl)}}}])}();
//# sourceMappingURL=tink-identity-card-number-angular.min.map